<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
  <data>

      <record id="view_e_formulaire_filter" model="ir.ui.view">
        <field name="name">e.formulaire.filter</field>
        <field name="model">e.formulaire</field>
        <field name="arch" type="xml">
            <search string="Search e-Formulaire">
                <field name="employee_id"/>
                <field name="department_id" operator="child_of"/>
                <field name="e_formulaire_type_id"/>
                <filter domain="[('state','in',('en_cour','a_payer'))]" string="En cours de traitement" name="en_coure"/>
                <filter domain="[('state', '=', 'suspendu')]" string="Suspendu" name="suspendu"/>
                <filter string="Approuvé" domain="[('state', '=', 'approuve')]" name="approuve"/>
                <separator/>
                <filter string="Mon Department" name="department" domain="[ ('employee_id.user_id', '=', uid)]" help="My Department Time Off"/>
                <!--filter string="People I Manage" name="managed_people" domain="[('employee_id.leave_manager_id', '=', uid)]" help="Time off of people you are manager of"/-->
                <filter string="Mon Formulaire" name="my_formulaire" domain="[('employee_id.user_id', '=', uid)]"/>
                <separator/>
                <filter name="filter_date_from" date="date_request"/>
                <separator/>
                <filter name="year" string="Active Time Off"
                    domain="[('e_formulaire_type_id.active', '=', True)]" help="Active Time Off"/>
                <filter invisible="1" string="Late Activities" name="activities_overdue"
                    domain="[('activity_ids.date_deadline', '&lt;', context_today().strftime('%Y-%m-%d'))]"
                    help="Show all records which has next action date is before today"/>
                <filter invisible="1" string="Today Activities" name="activities_today"
                    domain="[('activity_ids.date_deadline', '=', context_today().strftime('%Y-%m-%d'))]"/>
                <group expand="0" string="Group By">
                    <filter name="group_employee" string="Employee" context="{'group_by':'employee_id'}"/>
                    <filter name="group_type" string="Type" context="{'group_by':'e_formulaire_type_id'}"/>
                    <filter name="group_state" string="Status" context="{'group_by': 'state'}"/>
                    <separator/>
                    <filter name="group_date_from" string="Start Date" context="{'group_by':'date_request'}"/>
                </group>
                <searchpanel>
                    <field name="state" string="Status"/>
                </searchpanel>
            </search>
        </field>
    </record>

       <record id="e_formulaire_view_tree" model="ir.ui.view">
        <field name="name">e.formulaire.view.tree</field>
        <field name="model">e.formulaire</field>
        <field name="arch" type="xml">
            <tree string="e-Formulaire" sample="1">
                <field name="employee_id" widget="many2one_avatar_employee"/>
                <field name="department_id" optional="hidden"/>
                <field name="e_formulaire_type_id" class="font-weight-bold"/>
                <field name="date_request"/>
                <field name="date_exper"/>
                <field name="duree_validite" string="Durée"/>
                <field name="state" widget="badge" decoration-info="state == 'draft'" decoration-warning="state in ('suspendu','rejeter','auto_annulé','annuler')" decoration-success="state == 'approuve'"/>
                <field name="user_id" invisible="1"/>
                <field name="activity_exception_decoration" widget="activity_exception"/>
            </tree>
        </field>
    </record>

        <record id="e_formulaire_form"  model="ir.ui.view">
            <field name="name">e.formulaire.form</field>
            <field name="model">e.formulaire</field>
            <field name="priority">32</field>
            <field name="arch" type="xml">
                <form string="e-Formulaire">
                    <style>
                      .o_form_view .o_form_statusbar > .o_statusbar_status > .o_arrow_button.btn-primary.disabled {
                         background: #f9dfa6;
                      }
                      .o_form_view .o_form_statusbar > .o_statusbar_status > .o_arrow_button.btn-primary.disabled::after {
                         border-left-color: #f9dfa6;
                      }
                    </style>
                    <header>
                        <button string="Valider" name="action_valider" attrs="{'invisible':[('state','not in',['draft','en_cour'])]}" type="object" class="oe_highlight"/>
                        <button string="Approve" name="action_approve" states="confirm" type="object" class="oe_highlight"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,en_cour,confirm,approuve,annuler"/>

                    </header>
                    <sheet>
                        <div claas="oe_title">
                            <h1>
                                <field name="e_formulaire_type_id" nolabel="1"/>
                            </h1>
                        </div>
                        <group>
                            <group>
                                <field name="number"/>
                                <field name="partner_id" required="1"/>
                                <field name="rccm" />
                                <field name="ifu"/>
                                <field name="raison_sociale" invisible="1"/>
                            </group>
                            <group>
                                <field name="date_request"/>
                                <field name="date_approbation" attrs="{'invisible': [('state', 'not in', ['approuve'])]}"/>
                                <label for="duree_validite" string="Durée de Validitée" />
                                <div class="o_row" name="duree_validite">
                                    <field name="duree_validite"/>
                                    <field name="duration_unit" />
                                </div>
                                <field name="date_exper" readonly="1"/>
                                <field name="employee_id" string="Assigner à" attrs="{'invisible': [('multi_form_validation', '=', True)]}" />
                                <field name="department_id" attrs="{'invisible': [('multi_form_validation', '=', True)]}"/>
                            </group>
                        </group>
                        <group>
                            <group>
                                <field name="info_complementaire" />
                                <field name="observation" />
                            </group>
                            <group>
                                <field name="note" />
                                <field name="multi_form_validation" invisible="1" />
                                <field name="niveau1" invisible="1"/>
                            </group>
                        </group>
                        <!--
                        <group>
                            <group>
                                <field name="invest" />
                                <field name="cout"/>
                            </group>
                            <group string="Autres Info">

                            </group>
                        </group>
                        -->
                    </sheet>
                </form>
            </field>
          </record>
    <!--
      <record id="open_e_formulaire_to_approve" model="ir.actions.server">
            <field name="name">Approbations</field>
            <field name="model_id" ref="model_e_formulaire"/>
            <field name="binding_model_id" ref="model_e_formulaire"/>
            <field name="state">code</field>
            <field name="code">
                action = model._get_approval_requests()
            </field>
        </record>
    -->

      <record id="e_formuulaire_action" model="ir.actions.act_window">
          <field name="name">e-Formulaire</field>
          <field name="type">ir.actions.act_window</field>
          <field name="res_model">e.formulaire</field>
          <field name="view_mode">tree,form</field>
        </record>


    </data>
 </odoo>